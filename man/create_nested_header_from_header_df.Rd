% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/create_nested_header_from_header_df.R
\name{create_nested_header_from_header_df}
\alias{create_nested_header_from_header_df}
\title{Create nested Excel headers from a header definition data frame}
\usage{
create_nested_header_from_header_df(wb, sheet, header_df)
}
\arguments{
\item{wb}{An openxlsx workbook object.}

\item{sheet}{A sheet name (character string) within the workbook.}

\item{header_df}{A tibble or data frame with one or more header levels as
rows (`l1`, `l2`, …). Columns represent the final Excel columns.}
}
\value{
The modified workbook object (`wb`) with merged cells and styled nested
headers.
}
\description{
Builds multi-level (nested) headers in an Excel worksheet based on a structured header definition
table (`header_df`).

Each row in `header_df` represents one header level (e.g. top → bottom),
and each column corresponds to an Excel column.
}
\details{
The function:
\enumerate{
  \item Computes vertical merge metadata using \code{\link{produce_col_merge}}.
  \item Iterates through header levels to compute merge groupings and nesting
        structure between consecutive header rows.
  \item Calls \code{TGexcel::create_nested_header_style()} to apply merged-cell
        formatting for each header level pair.
  \item Finally merges vertically identical column header segments using
        \pkg{openxlsx} cell merge operations.
}
}
\examples{
\dontrun{
wb <- openxlsx::createWorkbook()
openxlsx::addWorksheet(wb, "Sheet1")

hdr <- tibble::tibble(
  l1 = c("Group A", "Group A", "Group B"),
  l2 = c("Total", "Male", "Total")
)
create_nested_header_from_header_df(wb, "Sheet1", hdr)
openxlsx::saveWorkbook(wb, "nested_headers.xlsx", overwrite = TRUE)
}

}
