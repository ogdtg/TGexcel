% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/create_nested_header_from_header_df.R
\name{produce_col_merge}
\alias{produce_col_merge}
\title{Produce column merge metadata for nested Excel headers}
\usage{
produce_col_merge(header_df)
}
\arguments{
\item{header_df}{A data frame or tibble, where each column corresponds to a
header column in Excel and each row represents a header level (e.g. l1â€“l4).}
}
\value{
A list of length `ncol(header_df)`, where each element is a list with two
elements:
\describe{
  \item{`start`}{Row index of the first mergeable cell (NA if none).}
  \item{`end`}{Row index of the last mergeable cell.}
}
}
\description{
Internal helper that determines which cells in each column of a header
definition data frame (`header_df`) should be vertically merged when
building hierarchical headers in Excel.
}
\details{
For each column, the function finds the **last non-`NA` value** in the column.
If that value is not in the final row, the rows from that position to the
bottom are marked for merging. If it *is* already the bottom, no merge is
needed.
}
\examples{
# Example header definition
hdr <- tibble::tibble(
  l1 = c("Group A", NA, NA),
  l2 = c("Sub A1", "Sub A2", NA),
  l3 = c(NA, NA, "Detail A3")
)
produce_col_merge(hdr)

}
